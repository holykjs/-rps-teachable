<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiplayer Test</title>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
    <h1>Multiplayer Connection Test</h1>
    <div id="status">Connecting...</div>
    <div id="log"></div>

    <script>
        const log = document.getElementById('log');
        const status = document.getElementById('status');
        
        function addLog(message) {
            const div = document.createElement('div');
            div.textContent = new Date().toLocaleTimeString() + ': ' + message;
            log.appendChild(div);
            console.log(message);
        }

        // Test Socket.IO connection
        const socket = io('http://localhost:3001', {
            transports: ['websocket', 'polling'],
            timeout: 5000,
        });

        socket.on('connect', () => {
            status.textContent = 'Connected ✅';
            addLog('Connected to multiplayer server');
            
            // Test creating a room
            socket.emit('create-room', 'TestPlayer');
        });

        socket.on('disconnect', () => {
            status.textContent = 'Disconnected ❌';
            addLog('Disconnected from server');
        });

        socket.on('connect_error', (error) => {
            status.textContent = 'Connection Error ❌';
            addLog('Connection error: ' + error.message);
        });

        socket.on('room-created', (data) => {
            addLog('Room created: ' + JSON.stringify(data));
        });

        socket.on('room-joined', (data) => {
            addLog('Room joined: ' + JSON.stringify(data));
        });

        socket.on('game-started', (data) => {
            addLog('Game started: ' + JSON.stringify(data));
        });

        socket.on('webrtc-offer', (offer) => {
            addLog('WebRTC offer received');
        });

        socket.on('webrtc-answer', (answer) => {
            addLog('WebRTC answer received');
        });

        socket.on('ice-candidate', (data) => {
            addLog('ICE candidate received');
        });

        // Test WebRTC functionality
        setTimeout(() => {
            addLog('Testing WebRTC signaling...');
            socket.emit('webrtc-offer', {
                roomId: 'TEST123',
                offer: { type: 'offer', sdp: 'test-sdp' }
            });
        }, 2000);
    </script>
</body>
</html>
